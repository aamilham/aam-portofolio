---
import { IExperiences } from "@types";
import { calculateDuration } from "@utils";

const { title, details } = Astro.props as IExperiences;
---

<section
  class="flex items-start justify-between flex-col sm:flex-row dark:text-light"
>
  <h2 class="w-[15rem] mt-16">{title}</h2>
  <div class="w-full mt-8">
    <div class="space-y-8">
      {
        details.map((item, index) => (
          <div class="relative pl-8 pb-8 border-l-2 border-indigo-200 dark:border-indigo-800 last:border-l-0 last:pb-0 group hover:border-indigo-400 dark:hover:border-indigo-600 transition-colors duration-300">
            {/* Timeline dot */}
            <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-indigo-500 dark:bg-indigo-400 ring-4 ring-white dark:ring-dark group-hover:scale-125 group-hover:ring-indigo-100 dark:group-hover:ring-indigo-900 transition-all duration-300"></div>
            
            <div class="bg-gradient-to-br from-gray-50 to-white dark:from-dark-gray dark:to-dark border-2 border-gray-200 dark:border-gray-700 rounded-lg p-5 hover:shadow-lg dark:hover:shadow-indigo-900/30 transition-all duration-300 group-hover:border-indigo-300 dark:group-hover:border-indigo-700">
              <div class="flex justify-between items-start flex-wrap gap-3 mb-3">
                <div class="flex-1">
                  <h3 class="text-xl font-bold text-indigo-700 dark:text-indigo-400">
                    {item.name}
                  </h3>
                  {item.role && (
                    <p class="text-base font-semibold text-gray-700 dark:text-white mt-1">
                      {item.role}
                    </p>
                  )}
                </div>
                <div class="flex flex-col items-end gap-1">
                  <span class="inline-flex items-center gap-1.5 px-3 py-1 text-xs font-medium bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    {calculateDuration(item.startDate, item.endDate)}
                  </span>
                  <p class="text-xs text-gray-500 dark:text-white">
                    {item.startDate} - {item.endDate}
                  </p>
                </div>
              </div>

              {item.location && (
                <div class="flex items-center gap-1.5 mb-4 text-sm text-gray-600 dark:text-gray-400">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-indigo-500 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                  {item.location}
                </div>
              )}

              <ul class="space-y-2">
                {item.description.map((desc) => (
                  <li class="flex items-start gap-2 text-sm text-gray-700 dark:text-white">
                    <span class="text-indigo-500 dark:text-indigo-400 mt-0.5 font-bold">â†’</span>
                    <span class="flex-1">{desc}</span>
                  </li>
                ))}
              </ul>

              {item.linkweb && (
                <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700">
                  <a 
                    href={item.linkweb} 
                    target="_blank"
                    rel="noopener noreferrer"
                    class="text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium inline-flex items-center gap-1.5 transition-colors group/link"
                  >
                    <span>Visit website</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 group-hover/link:translate-x-0.5 group-hover/link:-translate-y-0.5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                    </svg>
                  </a>
                </div>
              )}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
